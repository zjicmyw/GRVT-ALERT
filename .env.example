# GRVT 账户余额查询工具 - 环境变量配置示例
# 复制本文件为 .env 并填写你的实际配置

# ============================================
# 轮询配置
# ============================================
GRVT_POLL_INTERVAL=30  # 轮询间隔（秒），默认 30

# ============================================
# 自动平衡配置
# ============================================
GRVT_BALANCE_THRESHOLD_PERCENT=43  # 自动平衡触发阈值（百分比），默认 43%
GRVT_BALANCE_TARGET_PERCENT=48  # 自动平衡目标占比（百分比），默认 48%

# ============================================
# Funding 归集配置
# ============================================
GRVT_FUNDING_SWEEP_THRESHOLD=100  # 可选：资金账户归集阈值（默认 100 USDT）

# ============================================
# 通知配置
# ============================================
GRVT_DAILY_SUMMARY_TIME=16:30  # 每日汇总发送时间（北京时间 HH:MM）；留空或 "-" 可禁用
GRVT_ALERT_DEVICE_KEY=your_bark_device_key_here  # Bark 设备 Key
CHAT_ID=your_telegram_chat_id  # 本地 Telegram 网关 chat id（http://localhost:3000/send-message）
API_KEY=your_telegram_api_key  # 本地 Telegram 网关 API Key（X-API-Key）

# ============================================
# 全局环境
# ============================================
GRVT_ENV=prod  # 全局环境（prod, testnet, staging, dev）

# ============================================
# 单账户配置（向后兼容）
# ============================================
# GRVT_API_KEY=your_api_key_here
# GRVT_TRADING_ACCOUNT_ID=your_trading_account_id_here
# GRVT_PRIVATE_KEY=your_private_key_here  # 可选：只读余额查询时可不填
# GRVT_THRESHOLD=50000  # 可选：告警阈值

# ============================================
# 新格式配置（推荐）
# 交易账户与资金账户独立配置
# ============================================

# 交易账户 1 配置
GRVT_TRADING_API_KEY_1=your_trading_api_key_1
GRVT_TRADING_PRIVATE_KEY_1=your_trading_private_key_1
GRVT_TRADING_ACCOUNT_ID_1=your_trading_account_id_1
GRVT_RELATED_FUNDING_ACCOUNT_ID_1=0x...  # 可选：关联资金账户地址（以太坊地址）
GRVT_RELATED_MAIN_ACCOUNT_ID_1=your_main_account_id_1  # 可选：关联主账户 ID
GRVT_THRESHOLD_1=50000  # 可选：交易账户 1 告警阈值
GRVT_ENV_1=prod  # 可选：交易账户 1 环境

# 资金账户 1 配置
GRVT_FUNDING_API_KEY_1=your_funding_api_key_1
GRVT_FUNDING_PRIVATE_KEY_1=your_funding_private_key_1
GRVT_FUNDING_ACCOUNT_ID_1=your_funding_account_id_1  # 内部账户 ID（用于 API）
GRVT_FUNDING_ACCOUNT_ADDRESS_1=0x...  # 资金账户地址（以太坊地址，用于外部转账，需在 Address Book）
GRVT_RELATED_TRADING_ACCOUNT_ID_1=your_trading_account_id_1  # 可选：关联交易账户 ID
GRVT_RELATED_MAIN_ACCOUNT_ID_1=your_main_account_id_1  # 可选：关联主账户 ID
GRVT_ENV_1=prod  # 可选：资金账户 1 环境

# 交易账户 2 配置
GRVT_TRADING_API_KEY_2=your_trading_api_key_2
GRVT_TRADING_PRIVATE_KEY_2=your_trading_private_key_2
GRVT_TRADING_ACCOUNT_ID_2=your_trading_account_id_2
GRVT_RELATED_FUNDING_ACCOUNT_ID_2=0x...  # 可选：关联资金账户地址（以太坊地址）
GRVT_RELATED_MAIN_ACCOUNT_ID_2=your_main_account_id_2  # 可选：关联主账户 ID
GRVT_THRESHOLD_2=30000  # 可选：交易账户 2 告警阈值
GRVT_ENV_2=prod  # 可选：交易账户 2 环境

# 资金账户 2 配置
GRVT_FUNDING_API_KEY_2=your_funding_api_key_2
GRVT_FUNDING_PRIVATE_KEY_2=your_funding_private_key_2
GRVT_FUNDING_ACCOUNT_ID_2=your_funding_account_id_2  # 内部账户 ID（用于 API）
GRVT_FUNDING_ACCOUNT_ADDRESS_2=0x...  # 资金账户地址（以太坊地址，用于外部转账，需在 Address Book）
GRVT_RELATED_TRADING_ACCOUNT_ID_2=your_trading_account_id_2  # 可选：关联交易账户 ID
GRVT_RELATED_MAIN_ACCOUNT_ID_2=your_main_account_id_2  # 可选：关联主账户 ID
GRVT_ENV_2=prod  # 可选：资金账户 2 环境

# ============================================
# 说明
# ============================================
# 1. 交易账户 API Key 需要具备转账权限（非只读），用于交易账户间内部转账
# 2. 资金账户 API Key 需要具备转账权限（非只读），用于：
#    - 资金账户与交易账户之间内部转账
#    - 向其他 GRVT 资金账户外部转账
# 3. 关联账户 ID/地址可选，但建议配置用于转账流程
# 4. Main account ID 用于转账签名/流程，可从 API 响应获取
# 5. 自动平衡仅支持恰好 2 个交易账户
# 6. 交易账户与资金账户余额会分别查询和展示
# 7. 轮询间隔可按需求调整（默认 30 秒）
# 8. 平衡阈值与目标占比可按需求调整（默认 43% / 48%）
# 9. 外部转账必须配置资金账户地址（GRVT_FUNDING_ACCOUNT_ADDRESS_X）：
#    - 该地址是资金账户的以太坊地址（Funding Wallet Address）
#    - 可在 GRVT 账户设置中查看
#    - 转账目标地址必须先加入 Address Book

# ============================================
# 双账户 Maker 对冲配置（新增）
# ============================================
# 独立脚本入口：python grvt_dual_maker_hedge.py
# 告警通道：对冲脚本仅使用 Telegram 网关（CHAT_ID + API_KEY）
GRVT_HEDGE_LOOP_INTERVAL_SEC=2  # 主循环间隔（秒），越小反应越快但 API 频率更高
GRVT_HEDGE_ORDERBOOK_DEPTH=10  # 盘口深度参数（建议 10；接口不接受 1 会报 Depth is invalid）
GRVT_HEDGE_SDK_LOG_LEVEL=ERROR  # SDK 内部日志级别（建议 ERROR，减少 _post 噪音）
GRVT_HEDGE_SINGLE_ORDER_DIFF_THRESHOLD_USDT=20  # 若同标的 A/B 持仓差小于该值（U），每个账户该标的最多保留 1 个策略挂单（A最多1，B最多1）
GRVT_HEDGE_MAX_RUNTIME_SEC=0  # 最大运行时长（秒）；>0 到时自动停止，0 表示持续运行
GRVT_HEDGE_CANCEL_ON_STOP=1  # 停止时是否清理策略挂单（1 是，0 否）
GRVT_HEDGE_STOP_KEEP_STRATEGY_ORDERS=0  # 停止清理时每账户每标的保留的策略单数量（默认 0=全部撤销）
GRVT_HEDGE_POST_ONLY_MAX_RETRY=5  # post-only 下单失败后的单轮最大重试次数
GRVT_HEDGE_POST_ONLY_COOLDOWN_SEC=300  # 达到最大重试后，该标的冷却时间（秒）
GRVT_HEDGE_PARTIAL_FILL_TIMEOUT_SEC=1800  # 部分成交等待超时（秒），超时后按已成交增量入账
GRVT_HEDGE_STUCK_HOURS=6  # 未完成对冲超过该小时数触发即时告警
GRVT_HEDGE_MMR_ALERT_THRESHOLD=0.70  # 风险告警阈值：maintenance_margin/equity >= 该值
GRVT_HEDGE_SYMBOLS_FILE=config/hedge_symbols.json  # 标的策略配置文件路径（UTF-8 JSON）

# 标的策略配置文件说明（见 config/hedge_symbols.example.json）：
# - instrument: GRVT 标的 ID（例如 BNB_USDT_Perp，脚本也支持传 BNB_USDT_PERP 并自动规范化）
# - enabled: 是否启用（true/false）
# - order_notional_usdt: 每次下单名义金额（USDT）
# - imbalance_limit_usdt: 允许失衡阈值（USDT）
# - max_total_position_usdt: 增仓模式下的总持仓上限（|A| + |B|）
# - min_total_position_usdt: 减仓模式下的总持仓下限（|A| + |B|）
# - a_side_when_equal: A 账户在仓位相等时的基准方向（"buy" 或 "sell"）
# - position_mode: 仓位模式（"increase" 增仓 / "decrease" 减仓）
